import{D as t,C as e}from"./index.06ab4907.js";import{I as l}from"./ItemDataService.c010ee4d.js";import a from"./DataView.ebc25ff4.js";import{o as s,c as o,a as d,d as n,v as u,e as i,f as r,F as c,g as m,b as h}from"./vendor.7f2c6655.js";const p={components:{DataView:a},props:{cid:{required:!1}},data:()=>({customerChecked:!1,customerName:"",customerAddress:"",customerPhone:"",customerId:"",item:null,items:[],name:"",price:"",amount:"",amountsMeter:[],amountsYard:[],itemPrices:[],total:0,discount:0,discountSubTotal:0,paidAmount:0,dueAmount:0,renderComponent:!0,totalDueOfCus:0,viewAllDataBtn:!0}),methods:{getDue(e){let l=null;t.getByCustomer(e).then((t=>{l=t.data,console.log(l),this.totalDueOfCus=0;for(let e=0;e<l.length;++e)"0"==l[e].d_type?this.totalDueOfCus+=parseFloat(parseFloat(l[e].d_rate)*parseFloat(l[e].d_amount)):this.totalDueOfCus-=parseFloat(parseFloat(l[e].d_rate)*parseFloat(l[e].d_amount));this.totalDueOfCus=this.totalDueOfCus.toFixed(1),console.log("Due Total : ",this.totalDueOfCus)})).catch((t=>{console.log(t)}))},customerCheckOnChange(t){if(console.log(this.customerChecked),this.getDue(this.customerId),""==t)return this.customerChecked=!1,void(this.totalDueOfCus=0);this.customerChecked?e.get(t).then((t=>{t.data?(this.customerName=t.data.name,this.customerAddress=t.data.address,this.customerPhone=t.data.phone,this.customerId=t.data.id,this.viewAllDataBtn=!0):(this.customerName="",this.customerAddress="",this.customerPhone="",this.viewAllDataBtn=!1,this.customerChecked=!1),console.log(t.data)})).catch((t=>{console.log(t)})):(this.customerName="",this.customerAddress="",this.customerPhone="",this.viewAllDataBtn=!1)},loadUserById(t){e.get(t).then((t=>{t.data?(this.customerName=t.data.name,this.customerAddress=t.data.address,this.customerPhone=t.data.phone,this.customerId=t.data.id):(this.customerName="",this.customerAddress="",this.customerPhone=""),console.log(t.data)})).catch((t=>{console.log(t)}))},getItems(){this.amountsMeter=[],this.amountsYard=[],this.itemPrices=[],l.getAll().then((t=>{this.items=t.data,console.log(t.data);for(let e=0;e<this.items.length;++e)this.amountsMeter.push(0),this.amountsYard.push(0),this.itemPrices.push(0);console.log(this.amountsMeter)})).catch((t=>{console.log(t)}))},isNumber(t,e){var l=(t=t||window.event).which?t.which:t.keyCode;if(!(l>31&&(l<48||l>57)&&46!==l))return"-1"==e.indexOf(".")||(46==l&&t.preventDefault(),!0);t.preventDefault()},calcItemPrice(){this.total=0;for(let t=0;t<this.itemPrices.length;++t)this.amountsYard[t]=(1.094*this.amountsMeter[t]).toFixed(2),this.itemPrices[t]=(this.items[t].price*this.amountsYard[t]).toFixed(2),this.total+=parseFloat(this.itemPrices[t]);this.total=this.total.toFixed(2),this.discountSubTotal=this.total-this.discount,this.dueAmount=this.discountSubTotal-this.paidAmount},discardCustomerData(){this.amountsMeter=[],this.amountsYard=[],this.itemPrices=[],this.discount=0,this.paidAmount=0,this.getItems(),this.calcItemPrice()},saveCustomerData(){console.log("save btn");for(let e=0;e<this.amountsMeter.length;++e)this.amountsMeter[e]&&t.create({date:this.dateToday(),customerId:this.customerId,itemId:this.items[e].id,amount:(1.094*this.amountsMeter[e]).toFixed(2),rate:this.items[e].price,type:0}).then((t=>{console.log(t.data)})).catch((t=>{console.log(t)}));this.paidAmount&&t.create({date:this.dateToday(),customerId:this.customerId,itemId:0,amount:this.paidAmount,rate:1,type:2}).then((t=>{console.log(t.data)})).catch((t=>{console.log(t)})),this.discount&&t.create({date:this.dateToday(),customerId:this.customerId,itemId:0,amount:this.discount,rate:1,type:1}).then((t=>{console.log(t.data)})).catch((t=>{console.log(t)})),alert("Data Saved"),this.renderComponent=!1,this.$nextTick((()=>{this.renderComponent=!0}))},dateToday(){var t=new Date,e=t.getDate(),l=t.getMonth()+1;return e<10&&(e="0"+e),l<10&&(l="0"+l),t.getFullYear()+""+l+e}},created(){this.cid?(this.customerId=this.cid,this.customerChecked=!0,this.customerCheckOnChange(this.customerId),this.getDue(this.customerId)):this.viewAllDataBtn=!1,this.getItems()}},b=d("p",null,"New Data Entry",-1),g={class:""},y=d("label",{for:"customerId"},"ID :",-1),C=d("label",{for:"customerName"},"Customer Name :",-1),D=d("label",{for:"customerAddress"},"Address :",-1),I=d("br",null,null,-1),v=d("label",{for:"customerPhone"},"Phone :",-1),P=d("label",{for:"totalDue"},"Total Due : ",-1),f=h("Â  "),A=d("br",null,null,-1),x=d("br",null,null,-1),V={class:"mx-auto bg-green-300",border:"1"},U=d("thead",null,[d("th",null,"Item Name"),d("th",null,"Price"),d("th",null,"Amount(Meter)"),d("th",null,"Amount(Yard)"),d("th",null,"Item Price")],-1),k=d("td",null,[d("input",{readonly:"",disabled:""})],-1),w=d("td",null,[d("input",{readonly:"",disabled:""})],-1),N=d("td",null,[d("input",{readonly:"",disabled:""})],-1),F=d("td",null,[d("input",{value:"Total :",readonly:"",disabled:""})],-1),M=d("td",null,[d("input",{readonly:"",disabled:""})],-1),O=d("td",null,[d("input",{readonly:"",disabled:""})],-1),T=d("td",null,[d("input",{readonly:"",disabled:""})],-1),B=d("td",null,[d("input",{value:"Discount :",readonly:"",disabled:""})],-1),Y=d("td",null,[d("input",{readonly:"",disabled:""})],-1),S=d("td",null,[d("input",{readonly:"",disabled:""})],-1),K=d("td",null,[d("input",{readonly:"",disabled:""})],-1),_=d("td",null,[d("input",{value:"Grand Total :",readonly:"",disabled:""})],-1),j=d("td",null,[d("input",{readonly:"",disabled:""})],-1),$=d("td",null,[d("input",{readonly:"",disabled:""})],-1),q=d("td",null,[d("input",{readonly:"",disabled:""})],-1),E=d("td",null,[d("input",{value:"Paid Amount :",readonly:"",disabled:""})],-1),G=d("td",null,[d("input",{readonly:"",disabled:""})],-1),z=d("td",null,[d("input",{value:"Due :",readonly:"",disabled:""})],-1),H=d("div",null,null,-1);p.render=function(t,e,l,a,h,p){return s(),o("div",null,[d("div",null,[b,d("div",g,[n(d("input",{onChange:e[1]||(e[1]=t=>p.customerCheckOnChange(h.customerId)),type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>h.customerChecked=t)},null,544),[[u,h.customerChecked]]),y,n(d("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>h.customerId=t),name:"customerId",disabled:h.customerChecked},null,8,["disabled"]),[[i,h.customerId]]),C,n(d("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>h.customerName=t),name:"customerName",readonly:""},null,512),[[i,h.customerName]]),D,n(d("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>h.customerAddress=t),name:"customerAddress",readonly:""},null,512),[[i,h.customerAddress]]),I,v,n(d("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>h.customerPhone=t),name:"customerPhone",readonly:""},null,512),[[i,h.customerPhone]]),P,n(d("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=t=>h.totalDueOfCus=t),readonly:""},null,512),[[i,h.totalDueOfCus]]),f,h.viewAllDataBtn?(s(),o("button",{key:0,class:"bg-blue-400 rounded hover:bg-blue-700 hover:text-white",onClick:e[8]||(e[8]=e=>t.$router.push({name:"CustomerData",params:{cid:h.customerId}}))}," View All Data ")):r("",!0),A,x]),d("div",null,[d("table",V,[U,d("tbody",null,[(s(!0),o(c,null,m(this.items,((l,a)=>(s(),o("tr",{key:l.id},[d("td",null,[n(d("input",{"onUpdate:modelValue":t=>l.name=t,readonly:"",disabled:""},null,8,["onUpdate:modelValue"]),[[i,l.name]])]),d("td",null,[n(d("input",{onKeypress:e=>p.isNumber(t.event,l.price),onBlur:e[9]||(e[9]=(...t)=>p.calcItemPrice&&p.calcItemPrice(...t)),"onUpdate:modelValue":t=>l.price=t,class:"text-right"},null,40,["onKeypress","onUpdate:modelValue"]),[[i,l.price]])]),d("td",null,[n(d("input",{onBlur:e[10]||(e[10]=(...t)=>p.calcItemPrice&&p.calcItemPrice(...t)),onKeypress:e=>p.isNumber(t.event,h.amountsMeter[a]),"onUpdate:modelValue":t=>h.amountsMeter[a]=t,class:"text-right"},null,40,["onKeypress","onUpdate:modelValue"]),[[i,h.amountsMeter[a]]])]),d("td",null,[n(d("input",{onBlur:e[11]||(e[11]=(...t)=>p.calcItemPrice&&p.calcItemPrice(...t)),"onUpdate:modelValue":t=>h.amountsYard[a]=t,readonly:"",disabled:"",class:"text-right"},null,40,["onUpdate:modelValue"]),[[i,h.amountsYard[a]]])]),d("td",null,[n(d("input",{"onUpdate:modelValue":t=>h.itemPrices[a]=t,readonly:"",disabled:"",class:"text-right"},null,8,["onUpdate:modelValue"]),[[i,h.itemPrices[a]]])])])))),128)),d("tr",null,[k,w,N,F,d("td",null,[n(d("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>h.total=t),class:"text-right",readonly:"",disabled:""},null,512),[[i,h.total]])])]),d("tr",null,[M,O,T,B,d("td",null,[n(d("input",{onBlur:e[13]||(e[13]=(...t)=>p.calcItemPrice&&p.calcItemPrice(...t)),onKeypress:e[14]||(e[14]=e=>p.isNumber(t.event,h.discount)),"onUpdate:modelValue":e[15]||(e[15]=t=>h.discount=t),class:"text-right"},null,544),[[i,h.discount]])])]),d("tr",null,[Y,S,K,_,d("td",null,[n(d("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>h.discountSubTotal=t),class:"text-right",readonly:"",disabled:""},null,512),[[i,h.discountSubTotal]])])]),d("tr",null,[j,$,q,E,d("td",null,[n(d("input",{onKeypress:e[17]||(e[17]=e=>p.isNumber(t.event,h.paidAmount)),onChange:e[18]||(e[18]=(...t)=>p.calcItemPrice&&p.calcItemPrice(...t)),"onUpdate:modelValue":e[19]||(e[19]=t=>h.paidAmount=t),class:"text-right"},null,544),[[i,h.paidAmount]])])]),d("tr",null,[d("td",null,[d("button",{class:"bg-blue-500 text-white rounded hover:bg-blue-700 px-12",onClick:e[20]||(e[20]=(...t)=>p.saveCustomerData&&p.saveCustomerData(...t)),disabled:!h.customerChecked}," Save ",8,["disabled"])]),d("td",null,[d("button",{class:"bg-red-500 text-white rounded hover:bg-red-700 px-12",onClick:e[21]||(e[21]=(...t)=>p.discardCustomerData&&p.discardCustomerData(...t))}," Discard ")]),G,z,d("td",null,[n(d("input",{"onUpdate:modelValue":e[22]||(e[22]=t=>h.dueAmount=t),class:"text-right",readonly:"",disabled:""},null,512),[[i,h.dueAmount]])])])])])])]),H])};export default p;
